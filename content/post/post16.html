---
title: 【単発】10年物長期金利をフィッティングしてみる
author: Ayato Ashihara
date: '2019-08-29'
slug: post16
categories:
  - 単発
tags:
  - R
  - 時系列解析
  - 金融
image: img/portfolio/FRED.png
---



<!--more-->
<p>おはこんばんにちは。とある理由で10年物長期金利のフィッティングを行いたいと思いました。USデータを用いて解析してみます。まず、データを収集します。quantmodパッケージを用いて、FREDからデータを落としてきます。getsymbols(キー,from=開始日,src=“FRED”, auto.assign=TRUE)でできちゃうんですねー。便利です。ちなみにキーはFREDのHPで確認できます。</p>
<pre class="r"><code>library(quantmod)

# data name collected
symbols.name &lt;- c(&quot;10-Year Treasury Constant Maturity Rate&quot;,&quot;Effective Federal Funds Rate&quot;,&quot;
Consumer Price Index for All Urban Consumers: All Items&quot;,&quot;Civilian Unemployment Rate&quot;,&quot;3-Month Treasury Bill: Secondary Market Rate&quot;,&quot;Industrial Production Index&quot;,&quot;
10-Year Breakeven Inflation Rate&quot;,&quot;Trade Weighted U.S. Dollar Index: Broad, Goods&quot;,&quot;
Smoothed U.S. Recession Probabilities&quot;,&quot;Moody&#39;s Seasoned Baa Corporate Bond Yield&quot;,&quot;5-Year, 5-Year Forward Inflation Expectation Rate&quot;,&quot;Personal Consumption Expenditures&quot;)

# Collect economic data
symbols &lt;- c(&quot;GS10&quot;,&quot;FEDFUNDS&quot;,&quot;CPIAUCSL&quot;,&quot;UNRATE&quot;,&quot;TB3MS&quot;,&quot;INDPRO&quot;,&quot;T10YIEM&quot;,&quot;TWEXBMTH&quot;,&quot;RECPROUSM156N&quot;,&quot;BAA&quot;,&quot;T5YIFRM&quot;,&quot;PCE&quot;)
getSymbols(symbols, from = &#39;1980-01-01&#39;, src = &quot;FRED&quot;, auto.assign = TRUE)</code></pre>
<pre><code>##  [1] &quot;GS10&quot;          &quot;FEDFUNDS&quot;      &quot;CPIAUCSL&quot;      &quot;UNRATE&quot;       
##  [5] &quot;TB3MS&quot;         &quot;INDPRO&quot;        &quot;T10YIEM&quot;       &quot;TWEXBMTH&quot;     
##  [9] &quot;RECPROUSM156N&quot; &quot;BAA&quot;           &quot;T5YIFRM&quot;       &quot;PCE&quot;</code></pre>
<pre class="r"><code>macro_indicator &lt;- merge(GS10,FEDFUNDS,CPIAUCSL,UNRATE,TB3MS,INDPRO,T10YIEM,TWEXBMTH,RECPROUSM156N,BAA,T5YIFRM,PCE)
rm(GS10,FEDFUNDS,CPIAUCSL,UNRATE,TB3MS,INDPRO,T10YIEM,TWEXBMTH,RECPROUSM156N,BAA,T5YIFRM,PCE)

setwd(&quot;../htmlwidget&quot;)
library(DT)
DT.macro &lt;- datatable(as.data.frame(macro_indicator),colnames = symbols.name)
saveWidget(DT.macro, &quot;macro_indicator.html&quot;, selfcontained = T)
setwd(&quot;../post&quot;)</code></pre>
<p>データは
<a href="../../htmlwidget/macro_indicator/index.html">こちら</a>
から参照できます。では、推計用のデータセットを作成していきます。被説明変数は「10-Year Treasury Constant Maturity Rate(GS10)」です。説明変数は以下の通りです。</p>
<table>
<thead>
<tr class="header">
<th>説明変数名</th>
<th>キー</th>
<th>代理変数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Federal Funds Rate</td>
<td>FEDFUNDS</td>
<td>短期金利</td>
</tr>
<tr class="even">
<td>Consumer Price Index</td>
<td>CPIAUCSL</td>
<td>物価</td>
</tr>
<tr class="odd">
<td>Unemployment Rate</td>
<td>UNRATE</td>
<td>雇用関連</td>
</tr>
<tr class="even">
<td>3-Month Treasury Bill</td>
<td>TB3MS</td>
<td>短期金利</td>
</tr>
<tr class="odd">
<td>Industrial Production Index</td>
<td>INDPRO</td>
<td>景気</td>
</tr>
<tr class="even">
<td>Breakeven Inflation Rate</td>
<td>T10YIEM</td>
<td>物価</td>
</tr>
<tr class="odd">
<td>Trade Weighted Dollar Index</td>
<td>TWEXBMTH</td>
<td>為替</td>
</tr>
<tr class="even">
<td>Recession Probabilities</td>
<td>RECPROUSM156N</td>
<td>景気</td>
</tr>
<tr class="odd">
<td>Moody’s Seasoned Baa Corporate Bond Yield</td>
<td>BAA</td>
<td>リスクプレミアム</td>
</tr>
<tr class="even">
<td>Inflation Expectation Rate</td>
<td>T5YIFRM</td>
<td>物価</td>
</tr>
<tr class="odd">
<td>Personal Consumption Expenditures</td>
<td>PCE</td>
<td>景気</td>
</tr>
</tbody>
</table>
<p>かなり適当な変数選択ではあるんですが、マクロモデリング的に長期金利ってどうやってモデル化するかというとちゃんとやってない場合が多いです。DSGEでは効率市場仮説に従って10年先までの短期金利のパスをリンクしたものと長期金利が等しくなると定式化するのが院生時代のモデリングでした（マクロファイナンスの界隈ではちゃんとやってそう）。そういうわけで、短期金利を説明変数に加えています。そして、短期金利に影響を与えるであろう物価にかかる指標も3つ追加しました。加えて、景気との相関が強いことはよく知られているので景気に関するデータも追加しました。これらはそもそもマクロモデルでは短期金利は以下のようなテイラールールに従うとモデリングすることが一般的であることが背景にあります。</p>
<p><span class="math display">\[
r_t = \rho r_{t-1} + \alpha \pi_{t} + \beta y_{t}
\]</span>
ここで、<span class="math inline">\(r_t\)</span>は政策金利（短期金利）、<span class="math inline">\(\pi_t\)</span>はインフレ率、<span class="math inline">\(y_t\)</span>はoutputです。<span class="math inline">\(\rho, \alpha, \beta\)</span>はdeep parameterと呼ばれるもので、それぞれ慣性、インフレ率への金利の感応度、outputに対する感応度を表しています。<span class="math inline">\(\rho=0,\beta=0\)</span>の時、<span class="math inline">\(\alpha&gt;=1\)</span>でなければ合理的期待均衡解が得られないことは「テイラーの原理」として有名です。
その他、Corporate bondとの裁定関係も存在しそうなMoody’s Seasoned Baa Corporate Bond Yieldも説明変数に追加しています。また、欲を言えばVIX指数と財政に関する指標を追加したいところです。財政に関する指数はQuateryかAnnualyなので今回のようなmonthlyの推計には使用することができません。この部分は最もネックなところです。なにか考え付いたら再推計します。</p>
<p>では、推計に入ります。今回は説明変数が多いのでridge回帰を行い、有効な変数を絞り込みたいと思います。また、比較のためにOLSもやります。説明変数は被説明変数の1期前の値を使用します。おそらく、1期前でもデータの公表時期によっては翌月の推計に間に合わない可能性もありますが、とりあえずこれでやってみます。</p>
<pre class="r"><code># make dataset
traindata &lt;- na.omit(merge(macro_indicator[&quot;2003-01-01::2017-12-31&quot;][,1],stats::lag(macro_indicator[&quot;2003-01-01::2015-12-31&quot;][,-1],1)))
testdata  &lt;- na.omit(merge(macro_indicator[&quot;2016-01-01::&quot;][,1],stats::lag(macro_indicator[&quot;2016-01-01::&quot;][,-1],1)))

# fitting OLS
trial1 &lt;- lm(GS10~.,data = traindata)
summary(trial1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = GS10 ~ ., data = traindata)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.75683 -0.21102  0.00154  0.22050  0.69964 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   14.6105842  4.3437565   3.364 0.000988 ***
## FEDFUNDS      -0.2281525  0.1449398  -1.574 0.117670    
## CPIAUCSL      -0.0696664  0.0209329  -3.328 0.001112 ** 
## UNRATE        -0.2143573  0.0797112  -2.689 0.008015 ** 
## TB3MS          0.3305061  0.1421094   2.326 0.021440 *  
## INDPRO        -0.0671882  0.0260464  -2.580 0.010901 *  
## T10YIEM        1.1112254  0.1763376   6.302 3.43e-09 ***
## TWEXBMTH      -0.0318222  0.0117401  -2.711 0.007539 ** 
## RECPROUSM156N -0.0104952  0.0022041  -4.762 4.66e-06 ***
## BAA            0.7758102  0.0856821   9.055 9.23e-16 ***
## T5YIFRM       -0.4390203  0.1878507  -2.337 0.020823 *  
## PCE            0.0009085  0.0002499   3.636 0.000386 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2972 on 143 degrees of freedom
## Multiple R-squared:  0.9208, Adjusted R-squared:  0.9147 
## F-statistic: 151.1 on 11 and 143 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>自由度修正済み決定係数高めですね。2015/12/31までのモデルを使って、アウトサンプルのデータ(2016/01/01~)を予測し、平均二乗誤差を計算します。</p>
<pre class="r"><code>est.OLS.Y &lt;- predict(trial1,testdata[,-1])
Y &lt;- as.matrix(testdata[,1])
mse.OLS &lt;- sum((Y - est.OLS.Y)^2) / length(Y)
mse.OLS</code></pre>
<pre><code>## [1] 0.1520849</code></pre>
<p>次にridge回帰です。Cross Validation</p>
<pre class="r"><code># fitting ridge regression
library(glmnet)
trial2 &lt;- cv.glmnet(as.matrix(traindata[,-1]),as.matrix(traindata[,1]),family=&quot;gaussian&quot;,alpha=1)
plot(trial2)</code></pre>
<p><img src="/my_blog/post/post16_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>trial2$lambda.min</code></pre>
<pre><code>## [1] 0.0006950552</code></pre>
<pre class="r"><code>coef(trial2,s=trial2$lambda.min)</code></pre>
<pre><code>## 12 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                           1
## (Intercept)   11.0913765347
## FEDFUNDS      -0.0872570864
## CPIAUCSL      -0.0508651301
## UNRATE        -0.1871709994
## TB3MS          0.2058502593
## INDPRO        -0.0612950674
## T10YIEM        1.1416879545
## TWEXBMTH      -0.0206931552
## RECPROUSM156N -0.0098454812
## BAA            0.7470735428
## T5YIFRM       -0.4412856213
## PCE            0.0006705683</code></pre>
<p>Unemployment Rate、3-Month Treasury Bill、Breakeven Inflation Rate、Moody’s Seasoned Baa Corporate Bond Yield、Inflation Expectation Rateの回帰係数が大きくなるという結果ですね。失業率以外は想定内の結果です。ただ、今回の結果を見る限り景気との相関は低そうです（逆向きにしか効かない？）。MSEを計算します。</p>
<pre class="r"><code>est.ridge.Y &lt;- predict(trial2, newx = as.matrix(testdata[,-1]), s = trial2$lambda.min, type = &#39;response&#39;)
mse.ridge &lt;- sum((Y - est.ridge.Y)^2) / length(Y)
mse.ridge</code></pre>
<pre><code>## [1] 0.1322327</code></pre>
<p>ridge回帰のほうが良い結果になりました。ridge回帰で計算した予測値と実績値を時系列プロットしてみます。</p>
<pre class="r"><code>library(tidyverse)

ggplot(gather(data.frame(actual=Y[,1],prediction=est.ridge.Y[,1],date=as.POSIXct(rownames(Y))),key=data,value=rate,-date),aes(x=date,y=rate, colour=data)) +
  geom_line(size=1.5) +
  scale_x_datetime(breaks = &quot;6 month&quot;,date_labels = &quot;%Y-%m&quot;) +
  scale_y_continuous(breaks=c(1,1.5,2,2.5,3,3.5),limits = c(1.25,3.5))</code></pre>
<p><img src="/my_blog/post/post16_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>方向感はいい感じです。一方で、2016年1月からや2018年12月以降の急激な金利低下は予測できていません。この部分については何か変数を考えるorローリング推計を実施する、のいずれかをやってみないと精度が上がらなそうです。とりあえず、いったんこれでこの記事は終わりたいと思います。ここまで読み進めていただき、ありがとうございました。</p>
